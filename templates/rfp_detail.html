<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>RFP Detail - {{ opp['title'] }}</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body class="bg-light">
<div class="container my-4">
    <h1 class="mb-3">{{ opp['title'] }}</h1>
    <p><strong>Agency:</strong> {{ opp['agency'] }}</p>
    <p><strong>Category:</strong> {{ opp['category'] }}</p>
    <p><strong>Source:</strong> {{ opp['source'] }}</p>
    <p><strong>Issue Date:</strong> {{ opp['issue_date'] }} | <strong>Due Date:</strong> {{ opp['due_date'] }}</p>
    <p><strong>Status:</strong> {{ opp['status'] }}</p>
    <p><a href="{{ opp['url'] }}" target="_blank">View on Source</a></p>

    <hr>

    <h3>Scope & Requirements</h3>
    <p><strong>Summary:</strong> {{ opp['summary'] or 'Not provided' }}</p>
    <p><strong>Scope of Work:</strong> {{ opp['scope_of_work'] or 'Not found' }}</p>
    <p><strong>Requirements:</strong> {{ opp['requirements'] or 'Not found' }}</p>
    <p><strong>Terms & Conditions:</strong> {{ opp['terms'] or 'Not found' }}</p>
    <p><strong>Critical Requirements:</strong> {{ opp['critical_reqs'] or 'Not found' }}</p>
    <p><strong>Extracted Raw Text:</strong></p>
    <pre class="p-2 bg-white border">{{ opp['raw_text'] or 'Not available' }}</pre>

    <hr>

    <h3>Financials</h3>
    <table class="table table-bordered w-50">
        <tr><th>Budget (Planned)</th><td>${{ "%.2f"|format(opp['budget'] or 0) }}</td></tr>
        <tr><th>Budget (Published)</th><td>${{ "%.2f"|format(opp['budget_published'] or 0) }}</td></tr>
        <tr><th>Equipment Cost</th><td>${{ "%.2f"|format(opp['equipment_cost'] or 0) }}</td></tr>
        <tr><th>Labor Cost</th><td>${{ "%.2f"|format(opp['labor_cost'] or 0) }}</td></tr>
        <tr><th>Admin Cost</th><td>${{ "%.2f"|format(opp['admin_cost'] or 0) }}</td></tr>
        <tr><th>Total Cost</th><td>${{ "%.2f"|format(opp['total_cost'] or 0) }}</td></tr>
        <tr><th>Suggested Bid</th><td>${{ "%.2f"|format(opp['suggested_bid'] or 0) }}</td></tr>
        <tr><th>Profit Margin</th><td>{{ "%.1f"|format(opp['profit_margin'] or 0) }}%</td></tr>
    </table>

    <hr>

    <h3>Scoring</h3>
    <p><strong>AI Score:</strong> {{ opp['ai_score'] or 'N/A' }}</p>
    <p><strong>Human Score:</strong> {{ opp['human_score'] or 'Not yet reviewed' }}</p>
    <p><strong>Reasons:</strong> {{ opp['reasons'] or 'Not available' }}</p>

    <form method="post" action="{{ url_for('override_score', opp_id=opp['id']) }}">
        <div class="mb-3 w-25">
            <label for="score" class="form-label">Override Human Score:</label>
            <input type="number" class="form-control" id="score" name="score" min="0" max="100">
        </div>
        <button type="submit" class="btn btn-primary">Update Score</button>
    </form>

    <hr>

    <h3>POC & Location</h3>
    <p><strong>Point of Contact:</strong> {{ opp['poc'] or 'Not found' }}</p>
    <p><strong>Location:</strong> {{ opp['location'] or 'Not specified' }}</p>

    <a href="{{ url_for('index') }}" class="btn btn-secondary mt-3">‚Üê Back to Dashboard</a>
</div>
</body>
</html>
